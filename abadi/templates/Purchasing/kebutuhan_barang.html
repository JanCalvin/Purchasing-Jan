{% extends "purchasing/base.html" %}
{% load static %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}
<style>
  @keyframes fade-out {
    from { opacity: 1; }
    to { opacity: 0; }
  }

  .hide-table {
    animation: fade-out 0.2s ease-in-out forwards;
  }
</style>


{% endblock stylesheets %}

<!-- Page content  -->
{% block content %}
<div class="col-12 grid-margin">
  <div class="card">
    <div class="card-body">
      <h4 class="card-title">Pengadaan Barang : <span style="font-weight: lighter;">
        {{inputno_spk}}</span</h4>
      <br>
      <form class="form-sample" action="" method="get">
        <div class="row">
            <div class="col-lg-4">
              <div class="form-group">
                  <div class="input-group" style="margin-top: 20px;">
                            <input type="text" class="form-control" placeholder="Masukkan Nomor SPK"
                                aria-label="Masukkan Nomor SPK" name="inputno_spk" id="inputno_spk" list="listSPK" required>
                            <datalist id="listSPK">
                                {% for i in spkall %}
                                <option value="{{i.NoSPK}}">{{i.NoSPK}}</option>
                                {% endfor %}
                            </datalist>
                            <div class="input-group-append">
                                <button class="btn btn-sm btn-primary" type="submit">Search</button>
                            </div>
                    </div>
                </div>
            </div>
          </div>
      </form>
      {% if filterspk %}
      <div class="template-demo">
        <a href="/purchasing/kebutuhan_barang">
            <button type="button" class="btn btn-light btn-icon-text">
            <i class="typcn typcn-chevron-left btn-icon-prepend"></i>
            Kembali
            </button>
        </a>
     </div>
      <div class="row">
        <div class="col-lg-12 grid-margin stretch-card">
          <div class="card">
            <div class="card-body">
              <div class="table-responsive pt-3">
                <div style="display: flex;justify-content: right;">
                  <button id="hideTable" type="button" class="btn btn-primary btn-icon-text" style="padding: 10px 20px;">
                    <i class="typcn btn-icon-prepend"></i>
                    <span id="hideTableText">Hide</span>
                  </button>
                 
                </div>
                <div id="firstTable" style="display: block;">
                  <h4>Tabel Artikel</h4>
                  <table class="table table-bordered">
                    <thead>
                      <tr>
                        <th>No</th>
                        <th>Artikel</th>
                        <th>Jumlah</th>
                      </tr>
                    </thead>
                    <tbody id="tableBody">
                      {% for i in list_kode_art %}
                      <tr>
                        <td>{{forloop.counter}}</td>
                        <td>{{i.Kode_Artikel}}</td>
                        <td>{{i.Jumlah_Artikel}}</td>
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>

                </div>
                <div style="display: flex;justify-content: right;">
                  <button id="showTambahBarang" type="button" class="btn btn-success" style="margin-top: 20px;margin-right: 10px;">
                    <i class="typcn typcn-th-list" style="padding-right: 10px;"></i>
                    Tambah barang       
                  </button>
                  <button id="showSecondTableButton" type="button" class="btn btn-secondary" style="margin-top: 20px;margin-right: 10px;">
                    <i class="typcn typcn-th-list" style="padding-right: 10px;"></i>
                    Data Kebutuhan         
                  </button>
                  <button id="showSecondTableButton2" type="button" class="btn btn-primary" style="margin-top: 20px;">
                    <i class="typcn typcn-th-list" style="padding-right: 10px;"></i>
                    Rekap Pengadaan             
                  </button>
                </div>
                <form class="form-sample" action="" method="post">
                  {% csrf_token %}
                  <div id="tambahBarang" style="display:none;margin-top: 20px;" class="input-group">
                      <div class="form-group row">
                          <label class="col-sm-3 col-form-label">Nama Artikel</label>
                          <div class="col-sm-9">
                              <input type="text" class="form-control" placeholder="Masukkan nama artikel" aria-label="Masukkan nama artikel" name="input_nama_art" id="input_nama_art" list="list_art" required>
                              <datalist id="list_art">
                                  {% for i in artall %}
                                  <option value="{{i.KodeArtikel}}">{{i.KodeArtikel}}</option>
                                  {% endfor %}
                              </datalist>
                          </div>
                      </div>
                      <div class="form-group row">
                          <label class="col-sm-3 col-form-label">Jumlah Artikel</label>
                          <div class="col-sm-9">
                              <input type="number" class="form-control" name="input_jumlah_art" id="input_jumlah_art" placeholder="Masukkan jumlah artikel" required/>
                          </div>
                      </div>
                      
                      <button class="btn btn-sm btn-primary" type="submit">Submit</button>
                       
                  </div>
              </form>
              
             
                <div id="secondTable" style="display: none;" class="col-lg-12">

                  <h4 style="margin-top: 10px;">Tabel Kebutuhan Bahan</h4>
                  <table class="table table-bordered" style="table-layout: fixed;" >
                    <thead>
                      <tr>
                        <th>No</th>
                        <th>Artikel</th>
                        <th>Jumlah</th>
                        <th>Kode Bahan</th>
                        <th>Bahan Baku</th>
                        <th>Kebutuhan</th>
                        <th>Stok</th>
                        <th>Selisih</th>
                      </tr>
                    </thead>
                    <tbody id="tableBody">
                      {% for i in list_q_akhir %}
                      <tr>
                        <td>{{forloop.counter}}</td>
                        <td>{{i.Kode_Artikel}}</td>
                        <td>{{i.Jumlah_Artikel}}</td>
                        <td>{{i.Kode_Produk}}</td>
                        <td>{{i.Nama_Produk}}</td>
                        <td>{{i.Kebutuhan}}</td>
                        <td>{{i.Stok_Gudang}}</td>
                        <td>{{i.Selisih}}</td>
                     </tbody>
                     {% endfor %}
                    </tbody>
                  </table>

                </div>
                
                <div id="secondTable2" style="display: none;">
                  <table  class="table table-bordered" style="table-layout: fixed;"  >
                
                  <thead> 
                    <tr>
                      <th>No</th>
                      <th>Kode Bahan</th>
                      <th>Bahan Baku</th>
                      <th>Jumlah </th>
                    </tr>
                  
                  <h4 style="margin-top: 10px;">Tabel Rekap Pengadaan</h4>
                    
                      </tr>
                    </thead>
                    <tbody id="tableBody">
                      {% for key,value in rekap_pengadaan.items %}
                      <tr>
                        <td>{{forloop.counter}}</td>
                        <td>{{key}}</td>
                        <td>{{value.0}}</td>
                        <td>{{value.1}}</td>
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      {% endif %}
    </div>
  </div>
</div>
{% block javascripts %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
  document.getElementById('hideTable').addEventListener('click', function() {
    var firstTable = document.getElementById('firstTable');
    var buttonText = document.getElementById('hideTableText');

    if (firstTable.style.display === 'block' || firstTable.style.display === '') {
      firstTable.classList.add('hide-table');
      buttonText.textContent = 'Show';
      document.getElementById('hideTable').classList.remove('btn-primary');
      document.getElementById('hideTable').classList.add('btn-success');
    } else {
      firstTable.classList.remove('hide-table');
      buttonText.textContent = 'Hide';
      document.getElementById('hideTable').classList.remove('btn-success');
      document.getElementById('hideTable').classList.add('btn-primary');
    }
  });
</script>


<script>
  $(document).ready(function() {
    $('#hideTable').click(function() {
      var firstTable = $('#firstTable');
      var buttonText = $('#hideTableText');

      if (firstTable.is(':visible')) {
        firstTable.fadeOut();
        buttonText.text('Show');
        $('#hideTable').removeClass('btn-primary').addClass('btn-success');
      } else {
        firstTable.fadeIn();
        buttonText.text('Hide');
        $('#hideTable').removeClass('btn-success').addClass('btn-primary');
      }
    });
  });
</script>

<script>
  document.getElementById('showTambahBarang').addEventListener('click', function() {
      var tambahBarang = document.getElementById('tambahBarang');
      if (tambahBarang.style.display === 'none') {
          tambahBarang.style.display = 'table';
      } else {
          tambahBarang.style.display = 'none';
      }
  });
</script>
<script>
  document.getElementById('showSecondTableButton').addEventListener('click', function() {
      var secondTable2 = document.getElementById('secondTable');
      if (secondTable2.style.display === 'none') {
          secondTable2.style.display = 'table';
      } else {
          secondTable2.style.display = 'none';
      }
  });
</script>
<script>
  document.getElementById('showSecondTableButton2').addEventListener('click', function() {
      var secondTable2 = document.getElementById('secondTable2');
      if (secondTable2.style.display === 'none') {
          secondTable2.style.display = 'table';
      } else {
          secondTable2.style.display = 'none';
      }
  });
  </script>
{% endblock javascripts %}
{% endblock content %}